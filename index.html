<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plano de Trabalho</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f2f5; /* Light gray background for the page */
        }
        .form-container {
            max-width: 900px; /* Max width of the form */
            margin: 2rem auto; /* Centering the form */
            padding: 2rem; /* Padding around the form */
            background-color: white; /* White background for the form itself */
            border-radius: 0.5rem; /* Rounded corners for the form container */
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); /* Subtle shadow */
        }
        .form-section-title {
            background-color: #4A5568; /* Darker gray for section titles */
            color: white;
            padding: 0.5rem 1rem;
            font-weight: 600;
            border-radius: 0.25rem;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
        }
        .form-field {
            margin-bottom: 0.75rem; /* Space below each field */
        }
        .form-field label, .checkbox-group-label {
            display: block;
            font-weight: 500;
            margin-bottom: 0.25rem;
            font-size: 0.875rem; /* Slightly smaller label text */
            color: #2D3748; /* Dark gray for labels */
        }
        .checkbox-item {
            display: flex;
            align-items: center;
            margin-bottom: 0.5rem;
        }
        .checkbox-item input[type="checkbox"] {
            margin-right: 0.5rem;
            height: 1rem;
            width: 1rem;
            accent-color: #4A5568;
        }
        .checkbox-item label {
            font-weight: normal;
            font-size: 0.875rem;
            color: #2D3748;
            margin-bottom: 0; /* Reset margin for checkbox labels */
        }
        .form-field input[type="text"],
        .form-field input[type="email"],
        .form-field input[type="tel"],
        .form-field input[type="date"],
        .form-field input[type="number"],
        .form-field textarea {
            width: 100%;
            padding: 0.5rem 0.75rem;
            border: 1px solid #CBD5E0; /* Light gray border */
            border-radius: 0.25rem;
            font-size: 0.875rem;
            transition: border-color 0.2s;
        }
        .form-field input[type="text"]:focus,
        .form-field input[type="email"]:focus,
        .form-field input[type="tel"]:focus,
        .form-field input[type="date"]:focus,
        .form-field input[type="number"]:focus,
        .form-field textarea:focus {
            outline: none;
            border-color: #4299E1; /* Blue border on focus */
            box-shadow: 0 0 0 1px #4299E1;
        }
        .form-field input[readonly] {
            background-color: #F7FAFC; /* Lighter background for readonly fields */
            color: #718096; /* Grayer text for readonly */
        }
        .grid-cols-form {
            display: grid;
            grid-template-columns: repeat(1, minmax(0, 1fr)); /* Default to 1 column */
            gap: 1rem;
        }
        /* Responsive grid columns */
        @media (min-width: 640px) { /* sm */
            .sm\:grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
            .sm\:grid-cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }
            .sm\:grid-cols-4 { grid-template-columns: repeat(4, minmax(0, 1fr)); }
        }
        @media (min-width: 768px) { /* md */
            .md\:grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
            .md\:grid-cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }
            .md\:grid-cols-4 { grid-template-columns: repeat(4, minmax(0, 1fr)); }
        }
        .header-logos {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #E2E8F0; /* Separator line */
        }
        .header-logos img {
            max-height: 60px; /* Control logo size */
        }
        .header-logos .title-text {
            text-align: center;
            flex-grow: 1;
        }
        .header-logos .title-text h1 {
            font-size: 1.5rem; /* Larger main title */
            font-weight: 700;
            color: #2D3748;
            margin-bottom: 0.25rem;
        }
        .header-logos .title-text p {
            font-size: 0.875rem;
            color: #4A5568;
        }
        .btn-primary {
            background-color: #4A5568; /* Dark gray button */
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.375rem;
            font-weight: 600;
            text-align: center;
            cursor: pointer;
            transition: background-color 0.2s;
            border: none;
            display: inline-block; /* Allows margin auto for centering if needed */
            margin-top: 1.5rem;
        }
        .btn-primary:hover {
            background-color: #2D3748; /* Darker on hover */
        }
        .form-field small { /* Style for instruction text */
            display: block;
            font-size: 0.75rem;
            color: #718096;
            margin-top: 0.25rem;
        }

        /* For printing: ensure content is not cut off and styles are minimal */
        @media print {
            body {
                background-color: white;
                margin: 0;
                padding: 0;
                font-size: 10pt; /* Smaller font for print */
            }
            .form-container {
                max-width: 100%;
                margin: 0;
                padding: 1cm; /* Margins for printing */
                box-shadow: none;
                border-radius: 0;
                border: 1px solid #ccc; /* Add a border for print if desired */
            }
            .form-section-title {
                background-color: #E2E8F0 !important; /* Lighter gray for print, ensure it overrides */
                color: black !important;
                -webkit-print-color-adjust: exact; /* Ensures background colors print in Chrome/Safari */
                print-color-adjust: exact; /* Standard */
                border: 1px solid #ccc;
            }
            .form-field input[type="text"],
            .form-field input[type="email"],
            .form-field input[type="tel"],
            .form-field input[type="date"],
            .form-field input[type="number"],
            .form-field textarea,
            .checkbox-item label { /* Style checkbox labels for print */
                border: 1px solid #ccc !important; /* Ensure borders are visible */
                font-size: 9pt;
            }
            .checkbox-item input[type="checkbox"] { /* Hide actual checkbox, show state via text */
                display: none !important;
            }
            .btn-primary, .header-logos img:last-child /* Hide INOVATO logo and button for printing */ {
                display: none !important;
            }
            .header-logos img:first-child { /* UFT logo */
                 max-height: 40px;
            }
             .header-logos .title-text h1 {
                font-size: 12pt;
            }
             .header-logos .title-text p {
                font-size: 8pt;
            }
            .grid-cols-form { /* Ensure grid works well for print */
                display: grid !important; /* Override Tailwind's print utilities if needed */
            }
            /* Try to keep elements on the same page */
            .form-section-title, .form-field, .checkbox-group-label, .checkbox-item {
                page-break-inside: avoid;
            }
            .form-field small { display: none; } /* Hide instruction text in print */
        }
    </style>
</head>
<body>
    <div class="form-container" id="planoTrabalho">
        <header class="header-logos">
            <img src="https://placehold.co/150x60/E2E8F0/4A5568?text=UFT+Logo" alt="Logo UFT"
                 onerror="this.onerror=null;this.src='https://placehold.co/150x60/E2E8F0/4A5568?text=Logo+UFT';">
            <div class="title-text">
                <p class="font-semibold">AGÊNCIA DE INOVAÇÃO E TRANSFERÊNCIA DE TECNOLOGIA - INOVATO / UFT</p>
                <h1>PLANO DE TRABALHO</h1>
            </div>
            <img src="https://placehold.co/100x60/E2E8F0/4A5568?text=INOVATO" alt="Logo INOVATO"
                 onerror="this.onerror=null;this.src='https://placehold.co/100x60/E2E8F0/4A5568?text=INOVATO';">
        </header>

        <section>
            <h2 class="form-section-title">1. DADOS UFT</h2>
            <div class="grid-cols-form md:grid-cols-2">
                <div class="form-field">
                    <label for="uft_instituicao">INSTITUIÇÃO:</label>
                    <input type="text" id="uft_instituicao" name="uft_instituicao" value="Universidade Federal do Tocantins - UFT" readonly>
                </div>
                <div class="form-field">
                    <label for="uft_cnpj">CNPJ/MF:</label>
                    <input type="text" id="uft_cnpj" name="uft_cnpj" value="05.149.726/0001-04" readonly>
                </div>
                <div class="form-field md:col-span-2">
                    <label for="uft_endereco">ENDEREÇO:</label>
                    <input type="text" id="uft_endereco" name="uft_endereco" value="AV. NS 15, ALC NO 14, BLOCO IV" readonly>
                </div>
                <div class="form-field">
                    <label for="uft_ea">EA:</label>
                    <input type="text" id="uft_ea" name="uft_ea" value="FEDERAL" readonly>
                </div>
                 <div class="form-field">
                    <label for="uft_cidade">CIDADE:</label>
                    <input type="text" id="uft_cidade" name="uft_cidade" value="Palmas" readonly>
                </div>
                <div class="form-field">
                    <label for="uft_cep">CEP:</label>
                    <input type="text" id="uft_cep" name="uft_cep" value="77010-970" readonly>
                </div>
                <div class="form-field">
                    <label for="uft_telefone">DDD/TELEFONE:</label>
                    <input type="text" id="uft_telefone" name="uft_telefone" value="(63) 32328109" readonly>
                </div>
                <div class="form-field md:col-span-2">
                    <label for="uft_responsavel">NOME RESPONSÁVEL:</label>
                    <input type="text" id="uft_responsavel" name="uft_responsavel" value="Luis Eduardo Bovolato" readonly>
                </div>
                <div class="form-field">
                    <label for="uft_cargo_resp">CARGO:</label>
                    <input type="text" id="uft_cargo_resp" name="uft_cargo_resp" value="Professor" readonly>
                </div>
                <div class="form-field">
                    <label for="uft_funcao_resp">FUNÇÃO:</label>
                    <input type="text" id="uft_funcao_resp" name="uft_funcao_resp" value="Reitor" readonly>
                </div>
                 <div class="form-field">
                    <label for="uft_matricula_resp">MATRÍCULA:</label>
                    <input type="text" id="uft_matricula_resp" name="uft_matricula_resp" value="1413294" readonly>
                </div>
            </div>
        </section>

        <section>
            <h2 class="form-section-title">1.2 DADOS PARCEIRO INTERINSTITUCIONAL</h2>
            <div class="grid-cols-form md:grid-cols-2">
                <div class="form-field">
                    <label for="p1_instituicao">INSTITUIÇÃO:</label>
                    <input type="text" id="p1_instituicao" name="p1_instituicao">
                </div>
                <div class="form-field">
                    <label for="p1_cnpj">CNPJ/MF:</label>
                    <input type="text" id="p1_cnpj" name="p1_cnpj">
                </div>
                <div class="form-field md:col-span-2">
                    <label for="p1_endereco">ENDEREÇO:</label>
                    <input type="text" id="p1_endereco" name="p1_endereco">
                </div>
                <div class="form-field">
                    <label for="p1_ea">EA:</label>
                    <input type="text" id="p1_ea" name="p1_ea">
                </div>
                 <div class="form-field">
                    <label for="p1_cidade">CIDADE:</label>
                    <input type="text" id="p1_cidade" name="p1_cidade">
                </div>
                <div class="form-field">
                    <label for="p1_cep">CEP:</label>
                    <input type="text" id="p1_cep" name="p1_cep">
                </div>
                <div class="form-field">
                    <label for="p1_telefone">DDD/TELEFONE:</label>
                    <input type="text" id="p1_telefone" name="p1_telefone">
                </div>
                <div class="form-field md:col-span-2">
                    <label for="p1_responsavel">NOME RESPONSÁVEL:</label>
                    <input type="text" id="p1_responsavel" name="p1_responsavel">
                </div>
                <div class="form-field">
                    <label for="p1_cargo_resp">CARGO:</label>
                    <input type="text" id="p1_cargo_resp" name="p1_cargo_resp">
                </div>
                <div class="form-field">
                    <label for="p1_funcao_resp">FUNÇÃO:</label>
                    <input type="text" id="p1_funcao_resp" name="p1_funcao_resp">
                </div>
                 <div class="form-field">
                    <label for="p1_matricula_resp">MATRÍCULA:</label>
                    <input type="text" id="p1_matricula_resp" name="p1_matricula_resp">
                </div>
            </div>
        </section>

        <section>
            <h2 class="form-section-title">1.3 DADOS PARCEIRO INTERINSTITUCIONAL</h2>
             <div class="grid-cols-form md:grid-cols-2">
                <div class="form-field">
                    <label for="p2_instituicao">INSTITUIÇÃO:</label>
                    <input type="text" id="p2_instituicao" name="p2_instituicao">
                </div>
                <div class="form-field">
                    <label for="p2_cnpj">CNPJ/MF:</label>
                    <input type="text" id="p2_cnpj" name="p2_cnpj">
                </div>
                <div class="form-field md:col-span-2">
                    <label for="p2_endereco">ENDEREÇO:</label>
                    <input type="text" id="p2_endereco" name="p2_endereco">
                </div>
                <div class="form-field">
                    <label for="p2_ea">EA:</label>
                    <input type="text" id="p2_ea" name="p2_ea">
                </div>
                 <div class="form-field">
                    <label for="p2_cidade">CIDADE:</label>
                    <input type="text" id="p2_cidade" name="p2_cidade">
                </div>
                <div class="form-field">
                    <label for="p2_cep">CEP:</label>
                    <input type="text" id="p2_cep" name="p2_cep">
                </div>
                <div class="form-field">
                    <label for="p2_telefone">DDD/TELEFONE:</label>
                    <input type="text" id="p2_telefone" name="p2_telefone">
                </div>
                <div class="form-field md:col-span-2">
                    <label for="p2_responsavel">NOME RESPONSÁVEL:</label>
                    <input type="text" id="p2_responsavel" name="p2_responsavel">
                </div>
                <div class="form-field">
                    <label for="p2_cargo_resp">CARGO:</label>
                    <input type="text" id="p2_cargo_resp" name="p2_cargo_resp">
                </div>
                <div class="form-field">
                    <label for="p2_funcao_resp">FUNÇÃO:</label>
                    <input type="text" id="p2_funcao_resp" name="p2_funcao_resp">
                </div>
                 <div class="form-field">
                    <label for="p2_matricula_resp">MATRÍCULA:</label>
                    <input type="text" id="p2_matricula_resp" name="p2_matricula_resp">
                </div>
            </div>
        </section>

        <section>
            <h2 class="form-section-title">2. TÍTULO DO PROJETO</h2>
            <div class="form-field">
                <textarea id="titulo_projeto" name="titulo_projeto" rows="3" placeholder="Digite o título do projeto"></textarea>
            </div>
        </section>

        <section>
            <h2 class="form-section-title">3. COORDENADOR DO PROJETO</h2>
            <div class="grid-cols-form md:grid-cols-2">
                <div class="form-field md:col-span-2">
                    <label for="coord_nome">NOME COMPLETO:</label>
                    <input type="text" id="coord_nome" name="coord_nome">
                </div>
                <div class="form-field">
                    <label for="coord_titulacao">TITULAÇÃO:</label>
                    <input type="text" id="coord_titulacao" name="coord_titulacao">
                </div>
                <div class="form-field">
                    <label for="coord_campus">CAMPUS:</label>
                    <input type="text" id="coord_campus" name="coord_campus">
                </div>
                <div class="form-field">
                    <label for="coord_cargo">CARGO:</label>
                    <input type="text" id="coord_cargo" name="coord_cargo">
                </div>
                <div class="form-field">
                    <label for="coord_telefone">TELEFONE:</label>
                    <input type="tel" id="coord_telefone" name="coord_telefone">
                </div>
                <div class="form-field">
                    <label for="coord_email">E-MAIL:</label>
                    <input type="email" id="coord_email" name="coord_email">
                </div>
                <div class="form-field">
                    <label for="coord_lattes">LATTES:</label>
                    <input type="text" id="coord_lattes" name="coord_lattes" placeholder="Link para o currículo Lattes">
                </div>
            </div>
        </section>

        <section>
            <h2 class="form-section-title">4. PERÍODO DE VIGÊNCIA PREVISTO</h2>
            <div class="grid-cols-form sm:grid-cols-3">
                <div class="form-field">
                    <label for="vigencia_inicio">INÍCIO:</label>
                    <input type="date" id="vigencia_inicio" name="vigencia_inicio">
                </div>
                <div class="form-field">
                    <label for="vigencia_termino">TÉRMINO:</label>
                    <input type="date" id="vigencia_termino" name="vigencia_termino">
                </div>
                <div class="form-field">
                    <label for="vigencia_total_meses">TOTAL DE MESES:</label>
                    <input type="number" id="vigencia_total_meses" name="vigencia_total_meses" readonly>
                </div>
            </div>
        </section>

        <section>
            <h2 class="form-section-title">5. DADOS DOS CONTATOS DOS PARCEIROS INTERINSTITUCIONAIS</h2>
            <div class="mb-4 p-3 border border-gray-200 rounded-md">
                <p class="font-semibold mb-2 text-sm">Contato Parceiro 1:</p>
                <div class="grid-cols-form md:grid-cols-2">
                    <div class="form-field">
                        <label for="contato1_nome">NOME 1:</label>
                        <input type="text" id="contato1_nome" name="contato1_nome">
                    </div>
                    <div class="form-field">
                        <label for="contato1_email">E-MAIL:</label>
                        <input type="email" id="contato1_email" name="contato1_email">
                    </div>
                    <div class="form-field">
                        <label for="contato1_instituicao">INSTITUIÇÃO/SETOR:</label>
                        <input type="text" id="contato1_instituicao" name="contato1_instituicao">
                    </div>
                    <div class="form-field">
                        <label for="contato1_telefone">TELEFONE:</label>
                        <input type="tel" id="contato1_telefone" name="contato1_telefone">
                    </div>
                </div>
            </div>
            <div class="mb-4 p-3 border border-gray-200 rounded-md">
                <p class="font-semibold mb-2 text-sm">Contato Parceiro 2:</p>
                <div class="grid-cols-form md:grid-cols-2">
                    <div class="form-field">
                        <label for="contato2_nome">NOME 2:</label>
                        <input type="text" id="contato2_nome" name="contato2_nome">
                    </div>
                    <div class="form-field">
                        <label for="contato2_email">E-MAIL:</label>
                        <input type="email" id="contato2_email" name="contato2_email">
                    </div>
                    <div class="form-field">
                        <label for="contato2_instituicao">INSTITUIÇÃO/SETOR:</label>
                        <input type="text" id="contato2_instituicao" name="contato2_instituicao">
                    </div>
                    <div class="form-field">
                        <label for="contato2_telefone">TELEFONE:</label>
                        <input type="tel" id="contato2_telefone" name="contato2_telefone">
                    </div>
                </div>
            </div>
            <div class="p-3 border border-gray-200 rounded-md">
                <p class="font-semibold mb-2 text-sm">Contato Parceiro 3:</p>
                <div class="grid-cols-form md:grid-cols-2">
                    <div class="form-field">
                        <label for="contato3_nome">NOME 3:</label>
                        <input type="text" id="contato3_nome" name="contato3_nome">
                    </div>
                    <div class="form-field">
                        <label for="contato3_email">E-MAIL:</label>
                        <input type="email" id="contato3_email" name="contato3_email">
                    </div>
                    <div class="form-field">
                        <label for="contato3_instituicao">INSTITUIÇÃO/SETOR:</label>
                        <input type="text" id="contato3_instituicao" name="contato3_instituicao">
                    </div>
                    <div class="form-field">
                        <label for="contato3_telefone">TELEFONE:</label>
                        <input type="tel" id="contato3_telefone" name="contato3_telefone">
                    </div>
                </div>
            </div>
        </section>

        <section>
            <h2 class="form-section-title">6. ESCOLHA DA FUNDAÇÃO</h2>
            <div class="form-field">
                <label for="fundacao_apoio">FUNDAÇÃO DE APOIO:</label>
                <input type="text" id="fundacao_apoio" name="fundacao_apoio">
            </div>
            <div class="form-field mt-4">
                <label class="checkbox-group-label">JUSTIFICATIVA/CRITÉRIO PARA ESCOLHA DA FUNDAÇÃO (marcar mais de um se for o caso):</label>
                <div class="grid-cols-form md:grid-cols-2 mt-2 gap-x-8">
                    <div class="checkbox-item">
                        <input type="checkbox" id="just_unica_atender" name="justificativa_fundacao" value="unica_atender">
                        <label for="just_unica_atender">Única a atender o pedido de apoio realizado</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="just_projeto_captado" name="justificativa_fundacao" value="projeto_captado">
                        <label for="just_projeto_captado">Projeto proposto ou captado pela Fundação</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="just_experiencia_fap" name="justificativa_fundacao" value="experiencia_fap">
                        <label for="just_experiencia_fap">Experiência da FAP em apoiar a execução de projetos com características semelhantes</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="just_continuidade_projeto" name="justificativa_fundacao" value="continuidade_projeto">
                        <label for="just_continuidade_projeto">Continuidade ou novo projeto de características semelhantes a outro já realizado com a FAP</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="just_menor_orcamento" name="justificativa_fundacao" value="menor_orcamento">
                        <label for="just_menor_orcamento">Menor orçamento apresentado para despesas operacionais e administrativas</label>
                    </div>
                    <div class="checkbox-item items-start"> <input type="checkbox" id="just_outro" name="justificativa_fundacao_outro_check" value="outro_check" class="mt-1">
                        <div class="flex-grow">
                             <label for="just_outro" class="block">Outro: (fundamentar)</label>
                             <textarea id="just_outro_texto" name="justificativa_fundacao_outro_texto" rows="2" class="w-full mt-1" placeholder="Fundamente aqui"></textarea>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <section>
            <h2 class="form-section-title">7. CIÊNCIA DO COORDENADOR DO PROJETO</h2>
            <div class="form-field">
                <p class="text-sm text-gray-600 p-4 border rounded-md bg-gray-50">
                    Declaro, para os devidos fins, ter ciência das normas e procedimentos que regem a relação entre a Universidade Federal do Tocantins (UFT),
                    a Fundação de Apoio e o Coordenador do Projeto, comprometendo-me a cumpri-los integralmente.
                </p>
                <div class="mt-4">
                    <label for="ciencia_local_data" class="form-field label">Local e Data:</label>
                    <input type="text" id="ciencia_local_data" name="ciencia_local_data" placeholder="Ex: Palmas - TO, DD/MM/AAAA">
                </div>
                <div class="mt-6 border-t pt-4">
                     <label for="ciencia_assinatura" class="form-field label">Assinatura do Coordenador do Projeto:</label>
                    <div class="w-full h-16 border-b border-gray-400 mt-2"></div>
                    <p class="text-xs text-center text-gray-500 mt-1">(Assinatura)</p>
                </div>
            </div>
        </section>

        <section>
            <h2 class="form-section-title">8. OBJETIVO</h2>
            <div class="form-field">
                <textarea id="objetivo_projeto" name="objetivo_projeto" rows="4" placeholder="Descrever, resumidamente, o(s) objetivo(s) do projeto e metas a serem alcançadas, indicando os órgãos internos e/ou externos envolvidos; relação com outros projetos etc."></textarea>
            </div>
        </section>

        <section>
            <h2 class="form-section-title">9. JUSTIFICATIVA DO PROJETO</h2>
            <div class="form-field">
                <textarea id="justificativa_projeto" name="justificativa_projeto" rows="4" placeholder="Justificar a realização do Projeto, sua relevância acadêmica, a abrangência e benefícios de seus resultados (quantificando-os, se possível) para a UFT e/ou comunidade etc."></textarea>
            </div>
        </section>

        <section>
            <h2 class="form-section-title">10. CARACTERIZAÇÃO DOS INTERESSES RECÍPROCOS</h2>
            <div class="form-field">
                <textarea id="interesses_reciprocos" name="interesses_reciprocos" rows="4" placeholder="Descreva a caracterização dos interesses recíprocos."></textarea>
                <small>Preencher para Convênios Siconv.</small>
            </div>
        </section>

        <section>
            <h2 class="form-section-title">11. RELAÇÃO ENTRE A PROPOSTA E OS OBJETIVOS E DIRETRIZES DO PROGRAMA</h2>
            <div class="form-field">
                <textarea id="relacao_proposta_objetivos" name="relacao_proposta_objetivos" rows="4" placeholder="Descreva a relação entre a proposta e os objetivos e diretrizes do programa."></textarea>
                <small>Preencher para Convênios Siconv.</small>
            </div>
        </section>

        <section>
            <h2 class="form-section-title">12. PÚBLICO ALVO</h2>
            <div class="form-field">
                <textarea id="publico_alvo" name="publico_alvo" rows="3" placeholder="Descreva o público alvo do projeto."></textarea>
            </div>
        </section>

        <section>
            <h2 class="form-section-title">13. PROBLEMA A SER RESOLVIDO</h2>
            <div class="form-field">
                <textarea id="problema_resolver" name="problema_resolver" rows="4" placeholder="Descreva o problema a ser resolvido pelo projeto."></textarea>
            </div>
        </section>

        <section>
            <h2 class="form-section-title">14. RESULTADOS ESPERADOS</h2>
            <div class="form-field">
                <textarea id="resultados_esperados" name="resultados_esperados" rows="4" placeholder="Descrever sucintamente os resultados esperados."></textarea>
            </div>
        </section>
        <div class="text-center mt-8">
            <button id="gerarPdfBtn" class="btn-primary">Gerar PDF</button>
        </div>
    </div>

    <script>
        // Function to calculate total months
        function calcularTotalMeses() {
            const inicioInput = document.getElementById('vigencia_inicio');
            const terminoInput = document.getElementById('vigencia_termino');
            const totalMesesInput = document.getElementById('vigencia_total_meses');

            const dataInicio = new Date(inicioInput.value);
            const dataTermino = new Date(terminoInput.value);

            if (inicioInput.value && terminoInput.value && dataTermino >= dataInicio) {
                let anos = dataTermino.getFullYear() - dataInicio.getFullYear();
                let meses = dataTermino.getMonth() - dataInicio.getMonth();
                
                // Ajuste para incluir o mês de término completamente
                // Se o dia de término for maior ou igual ao dia de início, OU se o mês de término for diferente do mês de início
                // E o dia de término não for o último dia do mês (para evitar contar um mês a mais indevidamente em alguns casos)
                // Ou se for um período dentro do mesmo mês.

                let totalMeses = anos * 12 + meses;

                // Se a data de término for no mesmo mês ou em mês posterior, e o dia de término for igual ou superior ao dia de início,
                // ou se os meses forem diferentes, adiciona 1 para incluir o mês corrente.
                // Esta lógica tenta ser inclusiva para o mês de término.
                if (dataTermino > dataInicio) { // Garante que não é o mesmo dia exato ou data de término anterior
                    if (dataTermino.getMonth() !== dataInicio.getMonth() || dataTermino.getFullYear() !== dataInicio.getFullYear() || dataTermino.getDate() >= dataInicio.getDate()){
                         totalMeses +=1;
                    }
                } else if (dataTermino.getTime() === dataInicio.getTime()){ // Mesmo dia
                    totalMeses = 1; // Considera 1 mês se for o mesmo dia
                }


                if (totalMeses < 0) totalMeses = 0; 
                // Se a data de início for posterior à data de término, o cálculo pode dar negativo ou zero.
                // A condição dataTermino >= dataInicio já deveria tratar isso, mas é uma salvaguarda.
                // Se dataTermino for anterior a dataInicio, o campo deve ficar vazio ou mostrar 0.
                if (dataTermino < dataInicio) {
                    totalMeses = 0;
                }


                totalMesesInput.value = totalMeses > 0 ? totalMeses : '';

            } else {
                totalMesesInput.value = ''; 
            }
        }

        document.getElementById('vigencia_inicio').addEventListener('change', calcularTotalMeses);
        document.getElementById('vigencia_termino').addEventListener('change', calcularTotalMeses);

        document.getElementById('gerarPdfBtn').addEventListener('click', function () {
            const { jsPDF } = window.jspdf;
            const formElement = document.getElementById('planoTrabalho');
            
            html2canvas(formElement, {
                scale: 2, 
                useCORS: true,
                logging: true,
                onclone: (documentClone) => {
                    // Esconder o botão e o logo INOVATO no clone
                    const clonedButton = documentClone.getElementById('gerarPdfBtn');
                    if (clonedButton) clonedButton.style.display = 'none';
                    
                    const clonedInovatoLogo = documentClone.querySelector('header img:last-child');
                    if(clonedInovatoLogo) clonedInovatoLogo.style.display = 'none';

                    // Ajustar tamanho do logo UFT no clone para impressão
                    const clonedUFTLogo = documentClone.querySelector('header img:first-child');
                    if (clonedUFTLogo) clonedUFTLogo.style.maxHeight = '40px';


                    const clonedInputs = documentClone.querySelectorAll('input, textarea, select');
                    clonedInputs.forEach(clonedInput => {
                        const originalInput = document.getElementById(clonedInput.id);
                        if (originalInput) {
                            if (clonedInput.type === 'date' && originalInput.value) {
                                const dateValue = new Date(originalInput.value + "T00:00:00"); // Adiciona T00:00:00 para evitar problemas de fuso horário
                                const day = String(dateValue.getUTCDate()).padStart(2, '0');
                                const month = String(dateValue.getUTCMonth() + 1).padStart(2, '0');
                                const year = dateValue.getUTCFullYear();
                                clonedInput.outerHTML = `<span class="pdf-value-span">${day}/${month}/${year}</span>`;
                            } else if (clonedInput.type === 'checkbox') {
                                const label = documentClone.querySelector(`label[for="${clonedInput.id}"]`);
                                let labelText = label ? label.textContent : '';
                                if (clonedInput.id === 'just_outro') { // Checkbox "Outro"
                                    labelText = 'Outro: '; 
                                }
                                // Para o PDF, não vamos esconder o checkbox, mas sim mostrar seu estado
                                // A regra CSS @media print já esconde o input[type="checkbox"]
                                // Aqui, garantimos que o texto do label seja preservado e o estado indicado
                                const checkSpan = document.createElement('span');
                                checkSpan.className = 'pdf-value-span pdf-checkbox-span'; // Adiciona classe específica
                                checkSpan.innerHTML = `[${originalInput.checked ? 'X' : ' '}] ${labelText}`;
                                clonedInput.parentNode.replaceChild(checkSpan, clonedInput);

                            } else if (clonedInput.id === 'just_outro_texto' && originalInput.value) {
                                const valueSpan = document.createElement('span');
                                valueSpan.className = 'pdf-value-span pdf-textarea-span'; // Adiciona classe específica
                                valueSpan.style.display = 'block'; 
                                valueSpan.style.paddingLeft = '20px'; 
                                valueSpan.innerHTML = `Fundamentação: ${originalInput.value.replace(/\n/g, '<br>')}`;
                                clonedInput.parentNode.replaceChild(valueSpan, clonedInput);
                            } else if (clonedInput.tagName === 'INPUT' || clonedInput.tagName === 'TEXTAREA') {
                                const valueSpan = document.createElement('span');
                                valueSpan.className = 'pdf-value-span ' + (clonedInput.tagName === 'TEXTAREA' ? 'pdf-textarea-span' : 'pdf-input-span');
                                if (clonedInput.tagName === 'TEXTAREA' && originalInput.value) {
                                     valueSpan.innerHTML = originalInput.value.replace(/\n/g, '<br>');
                                } else {
                                     valueSpan.textContent = originalInput.value || '';
                                }
                                // Se o campo estiver vazio e for readonly, manter o placeholder visual
                                if (!originalInput.value && originalInput.readOnly && originalInput.placeholder) {
                                    valueSpan.textContent = originalInput.placeholder;
                                    valueSpan.style.color = '#718096'; // Cor do placeholder
                                } else if (!originalInput.value && !originalInput.readOnly) {
                                     valueSpan.innerHTML = '&nbsp;'; // Adiciona um espaço para manter a altura do campo
                                }
                                clonedInput.parentNode.replaceChild(valueSpan, clonedInput);
                            }
                        }
                    });
                    
                    // Esconder as instruções (tags <small>) no clone
                    const clonedSmallInstructions = documentClone.querySelectorAll('.form-field small');
                    clonedSmallInstructions.forEach(small => small.style.display = 'none');

                    const style = documentClone.createElement('style');
                    style.innerHTML = `
                        .pdf-value-span {
                            font-size: 9pt !important; /* Tamanho da fonte para o PDF */
                            padding: 0.3rem 0.5rem !important; /* Padding para o PDF */
                            border: 1px solid #ccc !important; /* Borda para o PDF */
                            display: block !important;
                            width: 100% !important;
                            border-radius: 0.15rem !important; /* Bordas levemente arredondadas */
                            box-sizing: border-box !important;
                            min-height: 1.8rem !important; /* Altura mínima aproximada de um campo */
                            line-height: 1.2 !important;
                            white-space: pre-wrap !important;
                            word-break: break-word !important;
                            background-color: #fff !important;
                            margin-bottom: 0.5rem !important; /* Espaçamento entre os spans */
                        }
                        .pdf-checkbox-span { /* Estilo específico para linhas de checkbox */
                            border: none !important;
                            padding: 0.1rem 0 !important;
                            min-height: auto !important;
                            margin-bottom: 0.25rem !important;
                        }
                        .pdf-textarea-span { /* Textareas podem precisar de mais altura */
                           /* min-height: 3rem !important; */ /* Ajuste conforme necessário */
                        }
                        /* Ajustes finos para títulos de seção no PDF */
                        .form-section-title {
                            font-size: 10pt !important;
                            padding: 0.3rem 0.6rem !important;
                            margin-top: 1rem !important;
                            margin-bottom: 0.5rem !important;
                        }
                        /* Ajustes para o cabeçalho no PDF */
                        .header-logos .title-text h1 { font-size: 12pt !important; }
                        .header-logos .title-text p { font-size: 8pt !important; }
                        .header-logos { padding-bottom: 0.5rem !important; margin-bottom: 1rem !important; }

                         /* Estilo para a declaração de ciência */
                        .form-field p.text-sm {
                            font-size: 9pt !important;
                            padding: 0.5rem !important;
                            border: 1px solid #ccc !important;
                        }
                        /* Estilo para local/data e assinatura */
                        .form-field label.form-field.label { font-size: 9pt !important; }
                        .mt-6.border-t.pt-4 { margin-top: 1rem !important; padding-top: 0.5rem !important; }
                        .w-full.h-16.border-b { height: 2rem !important; margin-top: 0.2rem !important; }
                        p.text-xs.text-center { font-size: 7pt !important; }
                    `;
                    documentClone.head.appendChild(style);
                }
            }).then(canvas => {
                const imgData = canvas.toDataURL('image/png');
                const pdf = new jsPDF({
                    orientation: 'p', 
                    unit: 'mm', 
                    format: 'a4' 
                });

                const pdfWidth = pdf.internal.pageSize.getWidth();
                const pdfHeight = pdf.internal.pageSize.getHeight();
                const margin = 10; // 10mm margin
                const contentWidth = pdfWidth - (2 * margin);
                
                const canvasWidth = canvas.width;
                const canvasHeight = canvas.height;
                const ratio = canvasWidth / canvasHeight;
                
                let imgActualWidth = contentWidth;
                let imgActualHeight = imgActualWidth / ratio;
                
                let totalPdfPages = Math.ceil(imgActualHeight / (pdfHeight - 2 * margin));
                if (totalPdfPages === 0) totalPdfPages = 1;

                let currentCanvasY = 0;
                const pageContentHeightInCanvasPx = ((pdfHeight - 2 * margin) / imgActualHeight) * canvasHeight;


                for (let i = 0; i < totalPdfPages; i++) {
                    const sourceHeight = Math.min(pageContentHeightInCanvasPx, canvasHeight - currentCanvasY);
                    
                    const tempCanvas = document.createElement('canvas');
                    tempCanvas.width = canvasWidth;
                    tempCanvas.height = sourceHeight;
                    const tempCtx = tempCanvas.getContext('2d');
                    
                    tempCtx.drawImage(canvas, 0, currentCanvasY, canvasWidth, sourceHeight, 0, 0, canvasWidth, sourceHeight);
                    
                    const pageImgData = tempCanvas.toDataURL('image/png');
                    const pageImgDisplayHeight = (sourceHeight / canvasWidth) * imgActualWidth;

                    if (i > 0) {
                        pdf.addPage();
                    }
                    pdf.addImage(pageImgData, 'PNG', margin, margin, imgActualWidth, pageImgDisplayHeight);
                    currentCanvasY += sourceHeight;
                }
                
                pdf.save('plano_de_trabalho.pdf');
            }).catch(error => {
                console.error("Erro ao gerar PDF:", error);
                const errorDiv = document.createElement('div');
                errorDiv.style.position = 'fixed';
                errorDiv.style.top = '10px';
                errorDiv.style.left = '50%';
                errorDiv.style.transform = 'translateX(-50%)';
                errorDiv.style.backgroundColor = 'rgb(220, 38, 38)'; // Tailwind red-600
                errorDiv.style.color = 'white';
                errorDiv.style.padding = '10px 15px';
                errorDiv.style.borderRadius = '0.375rem'; // Tailwind rounded-md
                errorDiv.style.boxShadow = '0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)'; // Tailwind shadow-lg
                errorDiv.style.zIndex = '1000';
                errorDiv.style.fontSize = '0.875rem'; // Tailwind text-sm
                errorDiv.textContent = "Erro ao gerar PDF: " + error.message + ". Verifique o console para mais detalhes.";
                document.body.appendChild(errorDiv);
                setTimeout(() => {
                    if (document.body.contains(errorDiv)) {
                         document.body.removeChild(errorDiv);
                    }
                }, 7000);
            });
        });
    </script>
</body>
</html>
